library(tidyverse)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1번
```{r}
E <- rnorm(1000, mean=0, sd=1)
head(E)

#1-2
library(dplyr)
t<-c()
for(i in 1:1000) t[i]=(2*pi*i/1000)
t[1]

x_1=c()
for(i in 1:1000)x_1[i]=sin(t[i])

x_2=c()
for(i in 1:1000)x_2[i]=cos(4*t[i])
#1-3
y<-c()
for(i in 1:1000)y[i]= 1.5 + 5*x_1[i] + 3*x_2[i] + E[i]
plot(t,y,col='gray60')

#1-4
D<-rep(1,1000)
X<-cbind(D,x_1,x_2)

#1-5
ceta<-c(1.5,5,3)
beta<-cbind(ceta)
Xbeta= X %*% beta
V<-as.vector(Xbeta)
lines(t,V,lwd=3,col='red')
#1-6
ymat<-matrix(y, byrow=FALSE, ncol=1)
Xt<-t(X)
XTT<-Xt%*%X
Xtt<-solve(XTT)
XTTT<-Xtt%*%Xt
betahat<-XTTT%*%ymat
ansvec<-X%*%betahat
VVV<-as.vector(ansvec)
head(VVV)  #betahat과 beta는 비슷한(거의같은) 값을 가진다.
head(V)
#1-7
lines(t,VVV,col='blue',lty=2,lwd=4)
```

## 2번
```{r}
xx<-runif(10000)
xx<-xx*1.96

yy<-runif(10000)

plot(xx,yy)

x<-seq(from=0, to=1.96, by=0.01)
y<-(1/sqrt(2*pi))*exp(-x^2/2)
lines(x,y,col='red',lwd=3)


test=function(xx,yy){
  yy < (1/sqrt(2*pi))*exp(-(xx)^2/2)
}

print(c(xx[1],yy[1]))
text(xx[1],yy[1])

tst=c()

for(i in 1:10000) tst[i]=test(xx[i],yy[i])

points(xx[tst],yy[tst],col='red')
sum(tst)
# 2425/10000*1.96 (원래의 적분은 -1.96부터 1.96이니까 이 함수가 우함수인점을 인지하여 *2를해야한다.)
#답:0.9506  #우리가 이론적으로 아는 0.95에 근접한다
```

```{R}
 #2-2
I=rnorm(1000)
t=rnorm(1000)
mean(I)
A=0
for (i in 1:100) (I[i]-mean(I)) 

```
## 3번
type(a)
```{r}
#ninesurv=0.5^n*0.95^(20-n)
#eightsurv=0.5^n*0.95^k*0.05*0.5^(20-n-k-1)

```
type(b)
```{r}
recent_per=1
recent_glass=0
countsur=0
Start=while(recent_glass<21){
 if (rbinom(1,size=1,prob=0.5)==1){
    recent_per=recent_per+0
    recent_glass=recent_glass+1
  }else{
    recent_per=recent_per+1
    recent_glass=recent_glass+1
  }
if(recent_per<=8){
countsur=countsur+1
}
}
restart = function(){
recent_per=1
recent_glass=0
}

sim_once = function(){
  start()
  restart()
  return(countsur)
}
simrslt=c()
#for(i in 1000) simrslt[i]=sim_once() 
simrslt
```             

##4번
```{r}
df=read_csv('https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/covid19.csv')
head(df)
df%>%group_by(year)%>%summarize(Totl0=sum(cases))
#답:60726(2020년) + 396889(2021년) 

#4-2
df%>%filter(year==2020, month==2,day>=1&day<=15)%>%
  group_by(prov)%>%summarize(Totl1=sum(cases)) #답:경기지역

#4-3
df%>%filter(year==2020, month==2,day>=16&day<=29)%>%
  group_by(prov)%>%summarize(Totl3=sum(cases)) #답:대구지역
```





## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


