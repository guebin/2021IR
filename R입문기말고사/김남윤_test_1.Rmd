---
title: "R 입문 기말고사"
author: "김남윤(202121204)"
date: "12/21/2021"
output:
  pdf_document:
    includes:
      in_header: head.tex
  html_document:
    df_print: paged
fontsize: 12pt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1번
## 1-(1)번
```{r}
epsilon_i<-rnorm(1000)
epsilon_i
```
## 1-(2)번
```{r}
k=1:1000
x1<-sin(2*pi*k/1000)
i=1:1000
x2<-cos(8*pi*i/1000)
```

## 1-(3)번
```{r}
r=1:1000
y<- 5*sin(2*pi*r/1000)+3*cos(8*pi*r/1000)+1.5 + epsilon_i
d=1:1000
t<-2*pi*d/1000
plot(t,y,col='gray60')
```
##1-(4)번
```{r}
X<-cbind(1,x1,x2)
X
```
##1-(5)번

```{r}
β<-rbind(1.5,5,3)
j<- X %*% β
plot(t,y,col='gray60')
lines(t,j,col='red',lwd='5')
```
##1-(6)번
```{r}
X<-cbind(1,x1,x2)
Y<-cbind(y)
A<- t(X)
B<- solve(A%*%X)
hatβ <- B %*% A %*% Y
```
##1-(7)번
```{r}
Xhatβ <- X%*%hatβ
plot(t,y,col='gray60')
lines(t,j,col='red',lwd='5')
lines(t,Xhatβ,lty="dashed",col="blue",lwd='5')
```
##2-(1)번
```{r}
x=seq(from=-1.96, to=1.96 , by=0.01)
y=1/sqrt(2*pi)*exp(-x^2/2)
plot(x,y)
xx=runif(10000)*4-2
yy=runif(10000)
plot(xx,yy)
lines(x,y,col='red',lwd=3)

test = function(xx,yy){
    yy < 1/sqrt(2*pi)*exp(-xx^2/2)
    }
tst = c()
for (i in 1:10000) tst[i] = test(xx[i],yy[i])
plot(xx,yy,col='gray')
lines(x,y,col='red',lwd=3)
points(xx[tst],yy[tst],col='red')
sum(tst)
```
##sum(tst)의 개수/1000*4 가 대략적인 넓이

##2-(2)번
```{r}
library(tidyverse)

x<-rnorm(1000)
dim(x) = c(1000,1)
X<-as_tibble(x)

X %>% filter(V1>-1.96 & V1<1.96)
```
## (-1.96~ 1.96 사이에 있는 확률변수의 개수는 filter의 개수이다.)

## 3번 (A)
```{r}
APR=c('N1','N2','N3','N4','N5','N6','N7','N8','A','N10')
SURV=10
PLAYER=APR[SURV]
STAGE=0
PROB=0.5
TOSSRSLT=NA
library(tidyverse)
toss=function(p) rbinom(n=1,size=1,prob=p) %>% as.logical

reset=function(){
  TOSSRSLT<<-NA
  SURV<<- 10
  STAGE<<- 0
  PLAYER<<- APR[SURV]
}

record=function(){
  list(PRE_TOSSRSLT=TOSSRSLT, SURV=SURV, STAGE=STAGE, PLAYER=PLAYER)
}

go= function(){
  PROB<<- 0.5+(PLAYER=='A')*0.45
  TOSSRSLT<<-toss(PROB)
  if (TOSSRSLT==FALSE) SURV<<-SURV-1  
  STAGE<<-STAGE+1
  PLAYER<<-APR[SURV]
}

gogo=function(){
      for(i in 1:20){ 
        go() 
       if (SURV==0) break
  }
}

gogo_history=function() {
  rslt_=as_tibble(record())
  for(i in 1:20){
    go()
    rslt_=rbind(rslt_,as_tibble(record()))
  }
  print(rslt_)
}

simulate_once=function(){
  reset()
  gogo()
  return(record()$SURV)
}

simrslt=c()
for (i in 1:1000) simrslt[i]=simulate_once()
mean(simrslt)
```
## 3번(B)
```{r}
APR=c('N10','A','N8','N7','N6','N5','N4','N3','N2','N1')
SURV=10
PLAYER=APR[SURV]
STAGE=0
PROB=0.5
TOSSRSLT=NA
library(tidyverse)

toss=function(p) rbinom(n=1,size=1,prob=p) %>% as.logical

reset=function(){
  TOSSRSLT<<-NA
  SURV<<- 10
  STAGE<<- 0
  PLAYER<<- APR[SURV]
}

record=function(){
  list(PRE_TOSSRSLT=TOSSRSLT, SURV=SURV, STAGE=STAGE, PLAYER=PLAYER)
}

go= function(){
  PROB<<-0.5+(PLAYER=='A')*0.45
  TOSSRSLT<<-toss(PROB)
  if (TOSSRSLT==FALSE) SURV<<-SURV-1
  STAGE<<-STAGE+1
  PLAYER<<-APR[SURV]
}

gogo=function(){
  for(i in 1:20){ 
    go() 
    if (SURV==0) break
  }
}

gogo_history=function() {
  rslt_=as_tibble(record())
  for(i in 1:20){
    go()
    rslt_=rbind(rslt_,as_tibble(record()))
  }
  print(rslt_)
}

simulate_once=function(){
  reset()
  gogo()
  return(record()$SURV)
}

simrslt=c()
for (i in 1:1000) simrslt[i]=simulate_once()
mean(simrslt)
```
## TYPE A 에서 살아남을 확률 계산결과 
## TYPE B 에서 살아남을 확률 계산결과
## 따라서 TYPE A에서 살아남을 확률이 더 크다

## 4번
```{r}
df=read_csv('https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/covid19.csv')
head(df)
df = as_tibble(df)
df %>% group_by(year)

## 2020년 확진자 수
df %>% filter(year==2020) %>%summarise(sum_cases=sum(cases))

##2021년 확진자 수
df %>% filter(year==2021) %>%summarise(sum_cases=sum(cases))

##4-(2)번

df %>% filter(year==2020 & month==2 & day<=15) %>% group_by(prov) %>% summarise(confirm=(sum(cases)))

```
## 2020년 2월 1일~15일 가장많은 확진자가 발견된 지역은 경기(9명)

##4-(3)번
```{r}

df %>% filter(year==2020 & month==2 & day>=16 & day <= 29) %>% group_by(prov) %>% summarise(confirm=(sum(cases)))

```
## 2020년 2월 16일 ~ 29일 까지 가장 많은 확진자가 발견된 지역은 대구(2055명)












This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
