---
title: "Untitled"
author: "R201816962"
date: '2021 12 21 '
output: pdf_document
---
i=1:1000
t=2*pi*i/1000

#1-1
e=rnorm(1000)
as.vector(e)

#1-2
x1=sin(t)
x2=cos(4*t)

#1-3
y=1.5+x1*5+x2*3+e
plot(t, y, main="Scatterplot", col='gray60')

#1-4
x=cbind(rep(1,1000),x1,x2)

#1-5
b=as.matrix(c(1.5,5,3))
xb=as.vector(x%*%b)
lines(t,xb,lty=1,lwd=5,col='red')

#1-6
b1=solve(t(x)%*%x)%*%t(x)%*%y1
#b와 비슷하다

#1-7
xb1=as.vector(x%*%b1)
lines(t,xb1, lty=2,lwd=5, col='blue')







 #2-1
x=seq(from=-1.96,to=1.96,by=0.01)
y=exp(-0.5*x^2)/sqrt(2*pi)

xx=runif(10000)
xx=xx*4-2
yy=runif(10000)*4
plot(xx,yy,col='gray')
lines(x,y,col='red',lwd=3)

test = function(xx,yy){
  yy < exp(-0.5*xx^2)/sqrt(2*pi)
}
tst = c()
for (i in 1:10000) tst[i] = test(xx[i],yy[i])
points(xx[tst],yy[tst],col='red')

16*sum(tst)/10000

#2-2
a=runif(1000)*4-2

length(a[(a<1.96)&(a>-1.96)])

#3
x=c()
for(i in 1:10000){
  chance=2
  succeess=0
  while(TRUE){
    if(chance!=1 && chance!=0){
      if(runif(1)>0.5){
        succeess=succeess+1
      }
      else{
        chance=chance-1
        succeess=succeess+1
      }
    }
    
    else if(chance ==1){
      if(runif(1)<0.95){
        succeess=succeess+1
      }
      else{
        chance=chance-1
        succeess=succeess+1
      }    
    }
    
    else{
      if(runif(1)>0.5){
        succeess=succeess+1
      }
      else {
        chance=chance-1
      }
    }
    
    if(chance==-1){
      x[i]=0
      break
    }
    if(succeess==20){
      x[i]=1
      break
    }
  }  
}
print(sum(x==1)/10000)



#오름차순
x2=c()
for(i in 1:10000){
  chance=7
  succeess=0
  while(TRUE){
    if(chance!=0){
      if(runif(1)>0.5){
        succeess=succeess+1
      }
      
      else{
        chance=chance-1
        succeess=succeess+1
      }
    }
    else{
      if(runif(1)>0.5){
        succeess=succeess+1
      }
      
      else{
        chance=chance-1
      }
      
      
    }
    
    if(chance==-1){
      x2[i]=0
      break
    }
    
    if(succeess==20){
      x2[i]=1
      break
    }
  }  
  
}
print(sum(x2==1)/10000)





#4-1
d=as.data.frame(df)
a=d[d$year==2020,5]
sum(a)

d=as.data.frame(df)
a1=d[d$year==2021,5]
sum(a1)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
