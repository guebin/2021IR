---
title: "R입문 기말고사"
author: "김지은(201816911)"
output:
  pdf_document:
    includes:
      in_header: head.tex 
---


## 1번 회귀분석
`-`**(1) e벡터생성**
```{r}
set.seed(1)
ei=rnorm(1000)
head(ei)
```

---

`-`**(2) x1,x2 생성**
```{r}
i=1:1000
ti= (2*pi*i) / 1000

i=1:1000
x1=sin(ti[i])
x2=cos(4*ti[i])
head(x1)
head(x2)
```

---

`-`**(3) y계산, 시각화**
```{r, fig.width=5,fig.height=4}

i=1:1000
yi=1.5+ (5*x1[i]) + (3*x2[i]) + ei[i]
head(yi)

df <- data.frame(ti,yi)
plot(x=ti,y=yi,col="gray60")
```

---

`-`**(4) 매트릭스 X 생성**
```{r}
X= cbind(1,x1,x2)
head(X)
```

---

**(5) 매트릭스 B 생성, 매트릭스곱으로 XB 계산, 시각화**
```{r, fig.width=5,fig.height=4}
B=matrix(c(1.5,5,3))
B

XB=X%*%B  #X와 B의 곱
XB_v=XB[,1]   #벡터화

plot(x=ti,y=yi,col="gray60")
lines(ti,XB_v , col = "Red",lwd=5)  #선 추가
```

---

**(6) Bhat 계산 , B와 비교** 
```{r}
X_t=t(X)  #전치행렬
B_hat=solve(X_t%*%X)%*%X_t%*%yi  # bhat구하기

B_hat
B
```

---

**(7)XBhat 계산, 시각화**
```{r, fig.width=5,fig.height=4}
XB_hat = X%*%B_hat

plot(x=ti,y=yi,col="gray60")
lines(ti,XB_v , col = "Red",lwd=5)  
lines(ti,XB_hat , col = "Blue",lwd=5, lty="dotdash")  #푸른점선추가
```



\newpage
## 2번 몬테카를로 적분
**(1) runif()이용. 몬테카를로 적분**
```{r, fig.width=4,fig.height=4}
set.seed(1)
x=seq(from=-1.96, to=1.96, by=0.01)
y=(1/sqrt(2*pi))*exp((1/2)*(x^2))
plot(x,y,type='l')

xx=runif(1000, min=-2, max=2)  #-2~2사이 임의 점 뽑기
yy=runif(1000, min=0, max=3) 

test = function(xx,yy){
    yy < (1/sqrt(2*pi))*exp((1/2)*xx^2)
}

tst = c()
for (i in 1:1000) tst[i] = test(xx[i],yy[i])

plot(xx,yy,col='gray')
lines(x,y,col='red',lwd=3)
points(xx[tst],yy[tst],col='red')  #선 아래 점 표시

sum(tst)
340/1000 * 12

```
=> 답: 4.08이다.

---

**(2) rnorm() 이용, 구간 값 count**
```{r}
set.seed(1)
x_2=rnorm(1000)
sum ( x_2 > -1.96 & x_2 <1.96 )
```
=> 답: 932개


\newpage
## 3번 징검다리

`-`  Type A : 10번->9번->8번->7번 .. 1번
```{r}
library(tidyverse)
ARR= c('N1','N2','N3','N4','N5','N6','N7','N8','N9','N10')

toss = function(p) rbinom(n=1,size=1,prob=p) %>% as.logical  #실행

reset = function(){  
    TOSSRSLT <<- NA
    SURV <<- 10
    STAGE <<- 0 
    PLAYER <<- ARR[SURV]
}

record = function(){
    list(PRE_TOSSRSLT=TOSSRSLT, SURV=SURV, STAGE=STAGE, PLAYER=PLAYER) 
}

go = function(){
    PROB <<- 0.5 + (PLAYER=='N9')*0.45   #9번은 0.95확률
    TOSSRSLT <<- toss(PROB) 
    if (TOSSRSLT==FALSE) SURV <<- SURV - 1   #일반유리 일때
    STAGE <<- STAGE + 1 
    PLAYER <<- ARR[SURV] 
}   

gogo = function() for(i in 1:20) go()  #20번 실행

simulate_once = function(){
    reset()
    gogo()
    return(record()$SURV )  #생존자 반환
}

```
=> 8번 참가자 생존 하는 경우 = SURV가 8명 이상인 경우 = 8,9,10명인 경우

```{r, eval=FALSE}
simrslt = c() 
for (i in 1:1000) simrslt[i] = simulate_once()
sum(simulate_once()>=8)/1000
```


\newpage
`-` Type B: 1번->2번->3번,..,8번->9번->10번
```{r}
ARR= c('N10','N9','N8','N7','N6','N5','N4','N3','N2','N1') 

toss = function(p) rbinom(n=1,size=1,prob=p) %>% as.logical

reset = function(){
    TOSSRSLT <<- NA
    SURV <<- 10
    STAGE <<- 0 
    PLAYER <<- ARR[SURV]
}
record = function(){
    list(PRE_TOSSRSLT=TOSSRSLT, SURV=SURV, STAGE=STAGE, PLAYER=PLAYER) 
}

go = function(){
    PROB <<- 0.5 
    TOSSRSLT <<- toss(PROB) 
    if (TOSSRSLT==FALSE) SURV <<- SURV - 1 
    STAGE <<- STAGE + 1 
    PLAYER <<- ARR[SURV]    
}   

gogo = function() for(i in 1:20) go()

simulate_once = function(){
    reset()
    gogo()
    return(record()$SURV )
}

```

```{r}
reset()
record()

gogo()
record()

```
=> 8번 참가자가 생존하는 경우 = 3명이상 생존하는 경우 = 3~10명인 경우

```{r}
simrslt = c() 
for (i in 1:1000) simrslt[i] = simulate_once() 
sum(simulate_once()>=3)/1000
```
=> 생존확률이 거의 0 ~ 0.001 정도 나옴


\newpage
## 4번 COVID19
**(1) 2020년, 2021년 총합**
```{r}
library(tidyverse)
df=read_csv('https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/covid19.csv')
head(df)

df %>% group_by(year) %>% summarise(sum_cases = sum(cases))
```
=> 2020년 확진자 수 = 60726명, 2021년 확진자 수 = 396886명으로 나타난다 



\newpage
**(2) 2020년 2월1일 ~ 2020년 2월15일 기간 확진자의 총합 지역별**
```{r}
df %>% filter(year==2020 & day >=1 & day <=15 & month ==2) %>% group_by(prov) %>% summarise(sum_cases = sum(cases))

```
=> 경기지역이 9명으로 가장 많은 확진자가 발생했다.

---

**(3) 2020년 2월16일 ~ 2020년 2월29일 기간 확진자의 총합 지역별**
```{r}
df %>% filter(year==2020 & day >=16 & day <=29 & month ==2) %>% group_by(prov) %>% summarise(sum_cases = sum(cases))
```
=> 대구가 2055명으로 가장 많은 확진자가 발생했다.
