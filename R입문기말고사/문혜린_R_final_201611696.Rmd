---
title: "R_final"
author: "문혜린(201611696)"
date: '2021 12 21 '
output: 
  pdf_document:
    includes:
      in_header: header.tex
---

# 문제 풀이

```{r}
library(tidyverse)
```

## 1번

### (1)

```{r}
epsilon = rnorm(100)
epsilon
```

### (2)

```{r}
i = 1:1000
t_i <- 2*pi*i/1000
x1 = sin(t_i)
x2 = cos(4*t_i)
head(x1)
head(x2)
```

### (3)

```{r}
y_i=1.5+5*x1+3*x2+epsilon
```

```{r}
plot(t_i,y_i,col='gray60')
```

### (4)

```{r}
X=cbind(1,x1,x2)
```

### (5)

```{r}
B=rbind(1.5,5,3)
V <- X %*% B
```

```{r}
plot(t_i,y_i,col='gray60')
lines(t_i,V,col='red',lwd=3)
```

### (6)

```{r}
X_t=rbind(1,x1,x2)
y=cbind(y_i)
```

```{r}
B_= solve(X_t %*% X) %*% X_t %*% y
B_
B
```

### (7)

```{r}
XB=X %*% B_
head(XB)
```

```{r}
plot(t_i,y_i,col='gray60')
lines(t_i,V,col='red',lwd=3)
lines(t_i,XB,col='blue',lty=2,lwd=3)
```


## 2번

### (1)

```{r}
x=seq(from=-1.96, to=1.96, by=0.01)
y=1/sqrt(2*pi)*exp(x^((-1/2)*x^2))
```

```{r}
xx=runif(10000)
xx=xx*2
yy=runif(10000)*1/sqrt(2)
```

```{r}
test=function(xx,yy){
  yy < 1/sqrt(2*pi)*exp(xx^((-1/2)*xx^2))
}

```{r}
tst=c()
for(i in 1:10000) tst[i]=test(xx[i],yy[i])

sum(tst)
```

```{r}
sum(tst)/10000
```

### (2)

```{r}
A = rnorm(1000,0,1)
```

```{r}
((-1.96)<=A & A <=(1.96)) %>% sum
```


## 3번

`-`TypeA

```{r}
surv10_prob=0.5^(20)
surv9_prob=c()
for (i in 0:19){
  surv9_prob[i+1]=0.5* 0.95^i * 0.5^(19-i)
}
surv8_prob=c()
for (i in 0:18){
  surv8_prob[i+1]=choose(19-i,1)*0.5*0.95^i * 0.05* 0.5^(18-i)
}
surv10_prob*10+ sum(surv9_prob)*9 + sum(surv8_prob)*8
```

`-` TypeB

```{r}
survprob10=0.5^(20)
survprob9=19*0.5*0.5*0.5^(18)
survprob8=18*0.5*0.5^2*0.5^(17)
survprob10+ survprob9 + survprob8
```


## 4번

### (1)
```{r}
df=read_csv('https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/covid19.csv')
head(df)
```


```{r}
df %>% group_by(year) %>%summarize(sum(cases))
```

### (2)

```{r}
df %>% filter(year==2021, month==2, day <=15) %>% group_by(prov) %>% summarise(sum(cases))
```

### (3)

```{r}
df %>% filter(year==2021, month==2, day >15) %>% group_by(prov) %>% summarise(sum(cases))
```